<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>–ë–∏—Ç–≤–∞ –ö–ª–∞–Ω–æ–≤: Telegram –≠–ø–æ—Ö–∞</title>
<style>
  body {
    background: #111;
    color: #eee;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 0; padding: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  header {
    padding: 20px;
    font-size: 1.5rem;
    font-weight: bold;
  }
  #team-selection, #pitch, #controls {
    width: 90vw;
    max-width: 600px;
    margin-bottom: 20px;
  }
  #team-selection {
    background: #222;
    padding: 10px;
    border-radius: 10px;
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    justify-content: center;
  }
  .player-card {
    background: #333;
    padding: 8px;
    border-radius: 8px;
    width: 80px;
    text-align: center;
    cursor: pointer;
    user-select: none;
    transition: background 0.3s;
  }
  .player-card.selected {
    background: #2196f3;
  }
  .player-name {
    font-weight: 600;
    font-size: 1rem;
  }
  .player-stats {
    font-size: 0.75rem;
    color: #ccc;
  }
  #pitch {
    background: #0a7000;
    border: 2px solid #0f0;
    border-radius: 15px;
    min-height: 350px;
    position: relative;
  }
  .pitch-player {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: #2196f3;
    color: white;
    font-weight: bold;
    text-align: center;
    line-height: 50px;
    position: absolute;
    user-select: none;
  }
  #controls {
    display: flex;
    justify-content: space-around;
  }
  button {
    background: #2196f3;
    border: none;
    padding: 10px 15px;
    color: white;
    font-weight: 600;
    font-size: 1rem;
    border-radius: 10px;
    cursor: pointer;
    transition: background 0.3s;
  }
  button:hover {
    background: #1769aa;
  }
  select {
    padding: 8px;
    border-radius: 8px;
    font-size: 1rem;
  }
  #result {
    background: #222;
    padding: 10px;
    border-radius: 10px;
    width: 90vw;
    max-width: 600px;
    min-height: 60px;
    color: #0f0;
    font-weight: bold;
    white-space: pre-wrap;
  }
</style>
</head>
<body>

<header>‚öΩ –ë–∏—Ç–≤–∞ –ö–ª–∞–Ω–æ–≤: Telegram –≠–ø–æ—Ö–∞</header>

<section id="team-selection">
  <!-- –ò–≥—Ä–æ–∫–∏ –ø–æ—è–≤—è—Ç—Å—è –∑–¥–µ—Å—å -->
</section>

<section id="pitch">
  <!-- –ò–≥—Ä–æ–∫–∏ –Ω–∞ –ø–æ–ª–µ -->
</section>

<section id="controls">
  <button id="auto-select">–ê–≤—Ç–æ–ø–æ–¥–±–æ—Ä —Å–æ—Å—Ç–∞–≤–∞</button>
  <select id="tactics">
    <option value="balanced">–°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è</option>
    <option value="attack">–ê—Ç–∞–∫–∞</option>
    <option value="defense">–ó–∞—â–∏—Ç–∞</option>
  </select>
  <button id="simulate">–°–∏–º—É–ª—è—Ü–∏—è –º–∞—Ç—á–∞</button>
  <button id="sendToBot">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ –±–æ—Ç–∞</button>
</section>

<section id="result"></section>

<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script>
  const tg = window.Telegram.WebApp;
  tg.expand();

  // –ü—Ä–∏–º–µ—Ä –∏–≥—Ä–æ–∫–æ–≤ —Å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏
  const players = [
    { id: 1, name: "–ò–≤–∞–Ω", strength: 7, speed: 8, agility: 6, talent: 7, bothFeet: 3 },
    { id: 2, name: "–ü–∞–≤–µ–ª", strength: 6, speed: 7, agility: 8, talent: 5, bothFeet: 2 },
    { id: 3, name: "–°–µ—Ä–≥–µ–π", strength: 5, speed: 9, agility: 7, talent: 6, bothFeet: 4 },
    { id: 4, name: "–î–º–∏—Ç—Ä–∏–π", strength: 8, speed: 5, agility: 5, talent: 8, bothFeet: 5 },
    { id: 5, name: "–ê–ª–µ–∫—Å–µ–π", strength: 6, speed: 6, agility: 9, talent: 6, bothFeet: 3 },
    { id: 6, name: "–ï–≤–≥–µ–Ω–∏–π", strength: 7, speed: 7, agility: 7, talent: 7, bothFeet: 4 },
    { id: 7, name: "–ú–∞–∫—Å–∏–º", strength: 5, speed: 8, agility: 8, talent: 5, bothFeet: 2 },
    { id: 8, name: "–ù–∏–∫–∏—Ç–∞", strength: 6, speed: 7, agility: 6, talent: 7, bothFeet: 3 },
    { id: 9, name: "–í–∏—Ç–∞–ª–∏–π", strength: 7, speed: 6, agility: 7, talent: 6, bothFeet: 4 },
    { id: 10, name: "–ê–Ω–¥—Ä–µ–π", strength: 8, speed: 5, agility: 7, talent: 5, bothFeet: 2 },
    { id: 11, name: "–û–ª–µ–≥", strength: 6, speed: 8, agility: 6, talent: 7, bothFeet: 3 },
    { id: 12, name: "–ò–≥–æ—Ä—å", strength: 7, speed: 7, agility: 7, talent: 8, bothFeet: 5 },
    { id: 13, name: "–†–æ–º–∞–Ω", strength: 5, speed: 9, agility: 8, talent: 6, bothFeet: 3 },
    { id: 14, name: "–í–ª–∞–¥–∏–º–∏—Ä", strength: 6, speed: 6, agility: 7, talent: 5, bothFeet: 2 },
    { id: 15, name: "–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω", strength: 7, speed: 7, agility: 6, talent: 7, bothFeet: 4 },
    { id: 16, name: "–°—Ç–∞–Ω–∏—Å–ª–∞–≤", strength: 6, speed: 8, agility: 7, talent: 6, bothFeet: 3 },
    { id: 17, name: "–ê–Ω–∞—Ç–æ–ª–∏–π", strength: 5, speed: 7, agility: 8, talent: 5, bothFeet: 2 },
    { id: 18, name: "–í–∏–∫—Ç–æ—Ä", strength: 8, speed: 6, agility: 6, talent: 7, bothFeet: 4 },
    { id: 19, name: "–ú–∏—Ö–∞–∏–ª", strength: 7, speed: 7, agility: 7, talent: 6, bothFeet: 3 },
    { id: 20, name: "–î–µ–Ω–∏—Å", strength: 6, speed: 8, agility: 5, talent: 7, bothFeet: 4 },
  ];

  const selectedPlayers = new Set();
  const pitchPositions = [
    { x: 260, y: 20 },  // –í—Ä–∞—Ç–∞—Ä—å
    { x: 100, y: 100 }, { x: 200, y: 100 }, { x: 320, y: 100 }, { x: 420, y: 100 }, // –ó–∞—â–∏—Ç–Ω–∏–∫–∏
    { x: 140, y: 200 }, { x: 240, y: 200 }, { x: 340, y: 200 }, // –ü–æ–ª—É–∑–∞—â–∏—Ç–Ω–∏–∫–∏
    { x: 200, y: 300 }, { x: 300, y: 300 }, { x: 260, y: 350 }, // –ù–∞–ø–∞–¥–∞—é—â–∏–µ
  ];

  const teamSelectionDiv = document.getElementById("team-selection");
  const pitchDiv = document.getElementById("pitch");
  const resultDiv = document.getElementById("result");
  const tacticsSelect = document.getElementById("tactics");

  // –°–æ–∑–¥–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏ –∏–≥—Ä–æ–∫–æ–≤ –¥–ª—è –≤—ã–±–æ—Ä–∞
  function renderPlayerCards() {
    teamSelectionDiv.innerHTML = "";
    players.forEach(player => {
      const card = document.createElement("div");
      card.classList.add("player-card");
      if(selectedPlayers.has(player.id)) card.classList.add("selected");
      card.dataset.id = player.id;
      card.innerHTML = `
        <div class="player-name">${player.name}</div>
        <div class="player-stats">
          –°–∏–ª–∞: ${player.strength}<br />
          –°–∫–æ—Ä–æ—Å—Ç—å: ${player.speed}<br />
          –õ–æ–≤–∫–æ—Å—Ç—å: ${player.agility}<br />
          –¢–∞–ª–∞–Ω—Ç: ${player.talent}<br />
          –û–±–µ –Ω–æ–≥–∏: ${player.bothFeet}
        </div>`;
      card.onclick = () => togglePlayer(player.id);
      teamSelectionDiv.appendChild(card);
    });
  }

  // –î–æ–±–∞–≤–ª—è–µ–º/—É–¥–∞–ª—è–µ–º –∏–≥—Ä–æ–∫–∞ –∏–∑ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö
  function togglePlayer(id) {
    if(selectedPlayers.has(id)) {
      selectedPlayers.delete(id);
    } else {
      if(selectedPlayers.size >= 11) {
        alert("–ú–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å —Ç–æ–ª—å–∫–æ 11 –∏–≥—Ä–æ–∫–æ–≤!");
        return;
      }
      selectedPlayers.add(id);
    }
    renderPlayerCards();
    renderPitch();
  }

  // –†–µ–Ω–¥–µ—Ä –∏–≥—Ä–æ–∫–æ–≤ –Ω–∞ –ø–æ–ª–µ
  function renderPitch() {
    pitchDiv.innerHTML = "";
    let idx = 0;
    selectedPlayers.forEach(id => {
      const player = players.find(p => p.id === id);
      if(!player) return;
      const pos = pitchPositions[idx] || { x: 10, y: 10 + idx*60 };
      const div = document.createElement("div");
      div.classList.add("pitch-player");
      div.style.left = pos.x + "px";
      div.style.top = pos.y + "px";
      div.textContent = player.name[0];
      div.title = `${player.name}\n–°–∏–ª–∞: ${player.strength}\n–°–∫–æ—Ä–æ—Å—Ç—å: ${player.speed}\n–õ–æ–≤–∫–æ—Å—Ç—å: ${player.agility}\n–¢–∞–ª–∞–Ω—Ç: ${player.talent}\n–û–±–µ –Ω–æ–≥–∏: ${player.bothFeet}`;
      pitchDiv.appendChild(div);
      idx++;
    });
  }

  // –ê–≤—Ç–æ–ø–æ–¥–±–æ—Ä - –≤—ã–±–∏—Ä–∞–µ—Ç 11 –ª—É—á—à–∏—Ö –ø–æ —Å—É–º–º–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
  function autoSelect() {
    selectedPlayers.clear();
    players
      .sort((a,b) => (b.strength + b.speed + b.agility + b.talent + b.bothFeet) - (a.strength + a.speed + a.agility + a.talent + a.bothFeet))
      .slice(0, 11)
      .forEach(p => selectedPlayers.add(p.id));
    renderPlayerCards();
    renderPitch();
  }

  // –ü—Ä–æ—Å—Ç–µ–π—à–∞—è —Å–∏–º—É–ª—è—Ü–∏—è –º–∞—Ç—á–∞
  function simulateMatch() {
    if(selectedPlayers.size !== 11) {
      alert("–í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–≤–Ω–æ 11 –∏–≥—Ä–æ–∫–æ–≤ –¥–ª—è —Å–∏–º—É–ª—è—Ü–∏–∏.");
      return;
    }
    const tactic = tacticsSelect.value;

    let score = 0;
    selectedPlayers.forEach(id => {
      const p = players.find(pl => pl.id === id);
      let playerScore = p.strength + p.speed + p.agility + p.talent + p.bothFeet;
      if(tactic === "attack") playerScore *= 1.1;
      else if(tactic === "defense") playerScore *= 0.9;
      score += playerScore;
    });
    score = Math.round(score / 11);

    let resultText = `–¢–∞–∫—Ç–∏–∫–∞: ${tactic.toUpperCase()}\n–°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª —Å–æ—Å—Ç–∞–≤–∞: ${score}\n\n`;

    if(score > 35) {
      resultText += "üéâ –í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ –º–∞—Ç—á!";
    } else if(score > 25) {
      resultText += "‚öñÔ∏è –ú–∞—Ç—á –∑–∞–≤–µ—Ä—à–∏–ª—Å—è –≤–Ω–∏—á—å—é.";
    } else {
      resultText += "üòû –í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏ –º–∞—Ç—á.";
    }
    resultDiv.textContent = resultText;
  }

  // –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Telegram-–±–æ—Ç–∞
  function sendToBot() {
    if(selectedPlayers.size !== 11) {
      alert("–í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–≤–Ω–æ 11 –∏–≥—Ä–æ–∫–æ–≤ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏.");
      return;
    }
    const lineup = Array.from(selectedPlayers).map(id => {
      const p = players.find(pl => pl.id === id);
      return {
        id: p.id,
        name: p.name,
        strength: p.strength,
        speed: p.speed,
        agility: p.agility,
        talent: p.talent,
        bothFeet: p.bothFeet
      };
    });
    const data = {
      lineup,
      tactic: tacticsSelect.value,
      timestamp: Date.now()
    };
    tg.sendData(JSON.stringify(data));
  }

  document.getElementById("auto-select").onclick = autoSelect;
  document.getElementById("simulate").onclick = simulateMatch;
  document.getElementById("sendToBot").onclick = sendToBot;

  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
  renderPlayerCards();

</script>

</body>
</html>
